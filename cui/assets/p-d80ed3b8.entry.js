/**
 * Cardholder UI Web Components v0.22.0
 * (c) 2024 Marqeta
 * @license MIT
 */
import{r as t,k as e,i as s,j as i}from"./p-18a64bdb.js";import"./p-52af63d3.js";import{a1 as a,a2 as r,a3 as n,c as o,a4 as d}from"./p-675e89df.js";import{g as l}from"./p-324125bc.js";import{o as m,m as h}from"./p-c7bc8265.js";import{D as c,a as p,C as u,S as b,b as g}from"./p-e506e796.js";import{C as f}from"./p-cb5bbf71.js";import"./p-0462f723.js";import"./p-bc4f08b6.js";const x=":host{width:100%}*{box-sizing:border-box}.mq-statements-list{align-items:flex-start;border:none;display:flex;flex-direction:column}.mq-statements-list-header{align-items:center;align-self:stretch;display:flex;justify-content:space-between;padding-bottom:var(--space-spacing600, 24px);width:100%}.mq-statements-list-toggle{display:flex;width:240px;height:var(--typography-number-numberLineHeight);padding:var(--space-spacing200, 8px) var(--space-spacing300, 12px);justify-content:space-between;align-items:center;gap:var(--space-spacing100, 4px)}.mq-statements-list-header .dropdown-list{margin:0px 2px;width:242px;box-sizing:border-box}.mq-statements-list-header .dropdown-header .mq-button{padding:0}.mq-statements-list-button{display:flex;width:240px;height:var(--typography-number-numberLineHeight);padding:var(--space-spacing200, 8px) var(--space-spacing300, 12px);justify-content:flex-end;align-items:center;gap:var(--space-spacing100, 4px)}.mq-statements-list-tbody{align-items:flex-start;display:flex;flex-direction:column}.mq-statement-row{align-items:center;align-self:stretch;background:var(--styles-background-surfacePrimaryColor);border:var(--styles-border-borderWidth) solid var(--colors-neutral-neutral200);border-bottom:none;display:flex;gap:var(--space-spacing400, 16px);height:56px;justify-content:space-between;opacity:1;padding:var(--space-spacing400, 16px)}mq-statement-asset{width:100%}mq-statement-asset .mq-statement-row td:first-of-type{display:flex}.mq-statement-asset-error{display:inline-flex;margin-left:var(--spacing-spacing200)}.mq-statement-asset-error mq-icon{margin-right:var(--spacing-spacing100);margin-top:2px}.loading.mq-statement-row:first-of-type,mq-statement-asset:first-of-type .mq-statement-row{border-top-right-radius:var(--borderRadius-radius200);border-top-left-radius:var(--borderRadius-radius200)}.loading.mq-statement-row:last-of-type,mq-statement-asset:last-of-type .mq-statement-row{border-bottom-right-radius:var(--borderRadius-radius200);border-bottom-left-radius:var(--borderRadius-radius200);border-bottom:var(--styles-border-borderWidth) solid var(--colors-neutral-neutral200)}.mq-statements-list-loader-container .mq-statement-row:first-of-type{border-top:none}.mq-statements-list-loader-container .mq-statement-row:last-of-type{border-bottom:none}.mq-statements-list-loader-container .mq-statement-row{border-left:none;border-right:none}.mq-statements-list-header.flexWrap{flex-wrap:wrap}.mq-statements-list-table{width:inherit}.mq-statements-list-table.xsTable{width:100%;margin-left:3px}.mq-statement-asset-download{display:flex;position:relative}.mq-statement-asset-download:focus{outline:none}.mq-statement-asset-download:focus::after{content:'';width:calc(100% + 4px);height:calc(100% + 4px);border:2px solid var(--styles-border-focusOutlineColor);border-radius:var(--borderRadius-radius100);position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}.mq-statement-asset-download:hover{cursor:pointer}.mq-spacer{margin-top:16px;width:100%}.load-more-btn{margin-top:var(--spacing-spacing600)}.mq-statements-list-header.xs .dropdown-list,.xs{width:100%}.sm{width:100%}.md,.lg,.xl{width:991px}";const y=x;const q=class{constructor(s){t(this,s);this.mqStatementListLoadInitiated=e(this,"mqStatementListLoadInitiated",7);this.mqStatementListLoadCompleted=e(this,"mqStatementListLoadCompleted",7);this.mqStatementListActionTriggered=e(this,"mqStatementListActionTriggered",7);this.mqStatementListActionCompleted=e(this,"mqStatementListActionCompleted",7);this.mqStatementsActionTriggered=e(this,"mqStatementsActionTriggered",7);this.handleLoadStatementsError=t=>{console.error({err:t});this.isLoading=false;this.errorMessage=c};this.handleDropdownOptionSelect=async t=>{this.issueDateSelection=t.detail;try{if(t.detail===p){this.setDefaultPaginationParams()}else{this.setYearPaginationParams(t.detail)}await this.tryLoadingStatements()}catch(t){this.handleLoadStatementsError(t)}};this.clickLoadMoreHandler=()=>{this.loadMoreStatements()};this.language="en";this.isLoading=true;this.isMore=false;this.errorMessage=null;this.size="md";this.componentWidth=`${u.md}px`;this.statementsPaginationParams={issuedEndDate:"",issuedStartDate:""};this.statements=[];this.issueDateOptions=[p];this.issueDateSelection=p}componentDidLoad(){var t;const e=l(this.el);this.size=e;this.componentWidth=`${(t=u[e])!==null&&t!==void 0?t:u.md}px`}connectedCallback(){m((t=>{const e=(new Date).getFullYear();this.issueDateOptions.push(e.toString(),(e-1).toString());t&&this.loadInitialStatements()}))}setDefaultPaginationParams(){const{VALID_ISSUED_END_DATE:t,VALID_ISSUED_START_DATE:e}=a();this.statementsPaginationParams={issuedEndDate:t,issuedStartDate:e}}setYearPaginationParams(t){const e=new Date(t,0,1);const s=new Date(t,11,31);this.statementsPaginationParams={issuedEndDate:r(s),issuedStartDate:r(e)}}setLoadMorePaginationParams(){const t=n(this.statementsPaginationParams.issuedStartDate);t.setFullYear(t.getFullYear()-1);const e=n(this.statementsPaginationParams.issuedStartDate);e.setMonth(e.getMonth()-1);this.statementsPaginationParams={issuedEndDate:r(e),issuedStartDate:r(t)}}async loadInitialStatements(){var t;this.mqStatementListLoadInitiated.emit();try{this.setDefaultPaginationParams();await this.tryLoadingStatements();this.mqStatementListLoadCompleted.emit({status:f.SUCCESS})}catch(e){this.handleLoadStatementsError(e);const s=(t=e===null||e===void 0?void 0:e.originalError)===null||t===void 0?void 0:t.message;this.mqStatementListLoadCompleted.emit({status:f.ERROR,error:{code:s||"STATEMENTS_INIT_LOAD_ERROR"}})}}async loadMoreStatements(){var t;this.mqStatementListActionTriggered.emit({type:b.LOAD_MORE_STATEMENTS_LIST});try{this.setLoadMorePaginationParams();await this.tryLoadingStatements(true);this.mqStatementListActionCompleted.emit({type:b.LOAD_MORE_STATEMENTS_LIST,status:f.SUCCESS})}catch(e){this.handleLoadStatementsError(e);const s=(t=e===null||e===void 0?void 0:e.originalError)===null||t===void 0?void 0:t.message;this.mqStatementListActionCompleted.emit({type:b.LOAD_MORE_STATEMENTS_LIST,status:f.ERROR,error:{code:s||c}})}}async tryLoadingStatements(t=false){this.isLoading=true;this.errorMessage=null;const e=o.get(d);const s=await e.execute(this.statementsPaginationParams);const{data:i}=s;this.addResponseDataToList(i,t);this.isMore=i.length>0;this.isLoading=false}addResponseDataToList(t,e){if(e){this.statements.push(...t)}else{this.statements=t}}render(){const t={width:"inherit"};if(!h.mqCuiReady){return null}return s("theme-provider",null,s("div",{class:`mq-statements-list ${this.size}`},s("flex-container",{styleOverride:t,flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"0"},s("div",{class:{"mq-statements-list-header":true,flexWrap:this.size==="xs",[this.size]:this.size==="xs"}},s("h2",{class:"statements-header"},s("mq-text",{type:"titleSection",content:"Monthly statements"})),this.renderDropdown()),!this.errorMessage&&this.renderStatementsList(),!this.errorMessage&&this.renderLoadingState(),this.renderEmptyState(),this.renderErrorState(),this.renderLoadMore())))}renderDropdown(){const t=this.isLoading||Boolean(this.errorMessage)||this.statements.length<1;return s("mq-dropdown",{options:this.issueDateOptions,label:"Select an option",onOptionSelected:this.handleDropdownOptionSelect},s("mq-button",{tabIndex:-1,disabled:t,kind:"secondary",small:true,accessibilityLabel:this.issueDateSelection,onClick:t=>t.preventDefault(),label:s("div",{class:`mq-statements-list-toggle ${this.size==="xs"?"xs":""}`},s("mq-text",{colorType:t?"tertiary":"primary"},this.issueDateSelection),s("mq-icon",{name:"chevron-down"}))}))}renderLoadingState(){if(this.isLoading){return s("div",{class:"mq-statements-list-loader-container"},s("table",{role:"grid",class:{"container-grid":true,"mq-statements-list-table":true,xsTable:this.size==="xs"}},s("tbody",{class:`mq-statements-list-tbody ${this.size}`},[...Array(7)].map(((t,e)=>s("tr",{key:e,class:"loading mq-statement-row"},s("mq-bone",{height:"16px",width:"200px"})))))))}}renderEmptyState(){if(!this.isLoading&&!this.errorMessage&&this.statements.length<1){const t={padding:"16px",width:this.componentWidth};return s("flex-container",{styleOverride:t,flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"0"},s("mq-text",null,g))}}renderErrorState(){if(this.errorMessage){const t={padding:"16px",width:this.componentWidth};return s("flex-container",{styleOverride:t,flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"0"},s("mq-text",null,this.errorMessage),s("div",{class:"mq-spacer"}),s("mq-button",{class:"refresh-btn",kind:"tertiary",onClick:()=>this.loadInitialStatements()},"Refresh"))}}renderStatementsList(){if(this.statements.length>0){return s("table",{role:"grid",class:{"container-grid":true,"mq-statements-list-table":true,xsTable:this.size==="xs"}},s("tbody",{class:"mq-statements-list-tbody"},this.statements.map((({cardholder_token:t,issued_date:e,readable_issued_date:i},a)=>{const r=`${e}-${a}`;return s("mq-statement-asset",{key:r,cardholderToken:t,issuedDate:e,readableIssuedDate:i,onDownloadEventTriggered:()=>this.mqStatementsActionTriggered.emit({type:b.DOWNLOAD_STATEMENTS_LIST})})}))))}}renderLoadMore(){const t=this.isMore&&!this.isLoading&&!this.errorMessage&&this.issueDateSelection===p;if(t){return s("div",{class:"load-more-btn"},s("mq-button",{kind:"tertiary",label:"Load more",onClick:this.clickLoadMoreHandler}))}}static get assetsDirs(){return["public"]}get el(){return i(this)}};q.style=y;export{q as mq_statement_list};
//# sourceMappingURL=p-d80ed3b8.entry.js.map