/**
 * Cardholder UI Web Components v0.22.0
 * (c) 2024 Marqeta
 * @license MIT
 */
import{r as t,k as i,d as s,i as a,j as e}from"./p-18a64bdb.js";import{i as r,C as o,f as n,a as c,b as l}from"./p-ac6d60ea.js";import{c as d,z as h,A as p,B as m,C as f}from"./p-675e89df.js";import{A as g}from"./p-52af63d3.js";import{o as u,m as x}from"./p-c7bc8265.js";import{C,D as b}from"./p-1c71d34b.js";import{C as y}from"./p-cb5bbf71.js";import"./p-0462f723.js";const v=".back-card-container{width:300px;height:186px;position:relative}.back-card{width:100%;height:100%;position:relative;display:flex;flex-direction:column;justify-content:flex-end;gap:var(--spacing-spacing0);box-sizing:border-box}.card-image{width:100%;height:100%;position:relative;border-radius:var(--borderRadius-radius300)}.details{position:absolute;top:0;left:0;right:0;bottom:0;flex-direction:column;justify-content:center;padding:var(--spacing-spacing400)}.details:focus-visible{outline:none;border:none}.back-card.details mq-text{color:var(--components-cardDetails-cardDetailsTextColor)}.back-card.details mq-text.small{opacity:0.8}.back-card.details mq-copy{color:var(--components-cardDetails-cardDetailsIconColor)}.back-card.details mq-copy mq-tooltip mq-text{color:var(--styles-text-textPrimaryColor)}";const q=v;const D=d.get(h);const k=d.get(p);const T=d.get(m);const P=class{constructor(s){t(this,s);this.mqCardBackLoadCompleted=i(this,"mqCardBackLoadCompleted",7);this.mqCardActionTriggered=i(this,"mqCardActionTriggered",7);this.mqCardActionCompleted=i(this,"mqCardActionCompleted",7);this.loadEnvConfigVars=()=>{this.cuiCardArtBaseUrl=T.execute("CDN_CARD_ART_BASE_URL")};this.loadCardPan=async()=>{try{await this.tryLoadCardPan()}catch(t){this.handleLoadCardPanError(t)}finally{this.isLoading=false}};this.tryLoadCardPan=async()=>{this.isLoading=true;this.errorMessage=null;const t=await k.execute(this.cardToken);if(t){const{cvvNumber:i,expiration:s,pan:a,state:e,instrumentType:n,user:c={firstName:"",middleName:"",lastName:""}}=t;const{firstName:l,middleName:d,lastName:h}=c;const p=`${l}${d?` ${d}`:""} ${h}`;this.cardNumber=a;this.cvv=i;this.expiry=s;this.cardState=e;this.isVirtual=r(n);this.cardHolderName=r(n)?p:null;const{cardProductToken:m}=await D.execute(this.cardToken);this.cardProductToken=m;const u=await f();this.programShortCode=u;this.mqCardBackLoadCompleted.emit({type:C.SHOW_BACK,status:y.SUCCESS,data:{cardToken:this.cardToken,cardType:this.isVirtual?o.VIRTUAL:o.DIGITAL}});g.CardManagement.showPanSuccess()}};this.handleCopyTriggered=t=>()=>{this.mqCardActionTriggered.emit({type:C[`COPY_${t}`],data:{cardToken:this.cardToken,cardType:this.isVirtual?o.VIRTUAL:o.DIGITAL}})};this.handleCopySuccess=t=>()=>{this.mqCardActionCompleted.emit({status:y.SUCCESS,type:C[`COPY_${t}`],data:{cardToken:this.cardToken,cardType:this.isVirtual?o.VIRTUAL:o.DIGITAL}})};this.handleCopyError=t=>i=>{var s;this.mqCardActionCompleted.emit({status:y.ERROR,type:C[`COPY_${t}`],data:{cardToken:this.cardToken,cardType:this.isVirtual?o.VIRTUAL:o.DIGITAL},error:{code:"COPY_ERROR",message:((s=i===null||i===void 0?void 0:i.detail)===null||s===void 0?void 0:s.errorMessage)||b}})};this.handleCardDetailsRefresh=()=>{this.loadCardPan()};this.handleImageLoad=()=>{this.backgroundImageLoaded=true};this.handleImageError=()=>{this.useFallbackImage=true};this.cardToken=undefined;this.backgroundImageLoaded=false;this.cardArtUrl=undefined;this.cardHolderName="";this.cardNumber="";this.cardProductToken=undefined;this.cardState="";this.cuiCardArtBaseUrl=undefined;this.cvv="";this.errorMessage=null;this.expiry="";this.isLoading=false;this.isVirtual=false;this.programShortCode=undefined;this.useFallbackImage=false}connectedCallback(){u((t=>{if(t){this.loadCardPan();this.loadEnvConfigVars()}}))}handleLoadCardPanError(t){var i;const s=t;const a=((i=s===null||s===void 0?void 0:s.originalError)===null||i===void 0?void 0:i.message)||"INTERNAL_ERROR";this.errorMessage=s.message||b;g.CardManagement.Exception(s.message);this.mqCardBackLoadCompleted.emit({type:C.SHOW_BACK,status:y.ERROR,data:{cardToken:this.cardToken,cardType:this.isVirtual?o.VIRTUAL:o.DIGITAL},error:{code:a,message:this.errorMessage}});g.CardManagement.showPanError()}render(){if(!this.cardToken||!x.mqCuiReady){return null}const t=!this.isLoading&&!this.errorMessage&&this.cardState!==l.ACTIVE;const i=!this.isLoading&&!this.errorMessage&&this.expiry&&this.cvv&&this.cardNumber;const e=this.isVirtual?s("virtual-card.png"):s("digital-card-back.png");const r=`${this.cuiCardArtBaseUrl}/${this.programShortCode}/cardproducts/${this.cardProductToken}/back.png`;const o=this.useFallbackImage?e:r;return a("theme-provider",null,a("div",{class:"back-card-container"},a("div",{class:"back-card"},this.isLoading&&a("mq-card-skeleton",null),this.errorMessage&&a("mq-card-error",{onRefreshCardDetailsButtonClick:()=>this.handleCardDetailsRefresh()}),i&&a("img",{class:"card-image",src:o,alt:"Your card art",tabindex:-1,onError:this.handleImageError,onLoad:this.handleImageLoad,style:{opacity:this.backgroundImageLoaded?"1":"0"}}),i&&a("div",{class:`back-card details`,tabIndex:t?-1:0},a("flex-container",{flexDirection:"column",justifyContent:"center",alignItems:"flex-start",gap:"var(--spacing-spacing400)"},a("flex-container",{flexDirection:"column",gap:"var(--spacing-spacing100)",flex:"initial"},this.cardHolderName&&a("mq-text",{id:"cardholder-name",styleOverride:{textTransform:"uppercase"}},this.cardHolderName),a("flex-container",{flexDirection:"row",gap:"var(--spacing-spacing300)",alignItems:"center",flex:"initial"},a("mq-text",{type:"large"},n(this.cardNumber)),a("mq-copy",{class:"mq-copy-pan",text:this.cardNumber,color:"var(--components-cardDetails-cardDetailsIconColor)",onMqCopyClipboardTriggered:this.handleCopyTriggered("PAN"),onMqCopyClipboardSuccess:this.handleCopySuccess("PAN"),onMqCopyClipboardError:this.handleCopyError("PAN"),isDisabled:t}))),a("flex-container",{flexDirection:"row",justifyContent:"flex-end",alignItems:"flex-start",gap:"var(--spacing-spacing1000)",styleOverride:{"flex-grow":"unset"}},a("flex-container",{flexDirection:"column",gap:"var(--spacing-spacing100)",flex:"initial"},a("mq-text",{small:true},"EXP"),a("flex-container",{id:"expiration",flexDirection:"row",gap:"var(--spacing-spacing300)",alignItems:"center",flex:"initial"},a("mq-text",null,c(this.expiry)),a("mq-copy",{class:"mq-copy-expiry",text:c(this.expiry),color:"var(--components-cardDetails-cardDetailsIconColor)",onMqCopyClipboardTriggered:this.handleCopyTriggered("EXP"),onMqCopyClipboardSuccess:this.handleCopySuccess("EXP"),onMqCopyClipboardError:this.handleCopyError("EXP"),isDisabled:t}))),a("flex-container",{flexDirection:"column",gap:"var(--spacing-spacing100)",flex:"initial"},a("mq-text",{small:true},"CVV"),a("flex-container",{id:"cvv",flexDirection:"row",gap:"var(--spacing-spacing300)",alignItems:"center",flex:"initial"},a("mq-text",null,this.cvv),a("mq-copy",{class:"mq-copy-cvv",text:this.cvv,color:"var(--components-cardDetails-cardDetailsIconColor)",onMqCopyClipboardTriggered:this.handleCopyTriggered("CVV"),onMqCopyClipboardSuccess:this.handleCopySuccess("CVV"),onMqCopyClipboardError:this.handleCopyError("CVV"),isDisabled:t})))))),t&&a("mq-card-disabled",{cardState:this.cardState}))))}get el(){return e(this)}};P.style=q;export{P as card_back};
//# sourceMappingURL=p-29999dbe.entry.js.map