/**
 * Cardholder UI Web Components v0.22.0
 * (c) 2024 Marqeta
 * @license MIT
 */
import{r as i,k as t,i as M,F as s,H as o,j as n}from"./p-18a64bdb.js";import{a}from"./p-b0df58a1.js";import{f as e,b as c,v as D,a as r}from"./p-4e66535e.js";import{c as u,y as N}from"./p-675e89df.js";import{o as I,m as g}from"./p-c7bc8265.js";import{A as T}from"./p-52af63d3.js";import{C as d}from"./p-cb5bbf71.js";import{L as j}from"./p-9fa6e82d.js";import"./p-0462f723.js";import"./p-324125bc.js";import"./p-bc4f08b6.js";import"./p-3b5975cd.js";const A=(i,t,M)=>{if(!i||!t||!M){return false}const s=new Date;const o=new Date(M,i,t);return o<s};const x=(i,t)=>{t.value=i.target.value.replace(/(\d{4})(?=\d)/g,"$1 ")};const E=(i,t)=>{if(i.target.value.length<2){if(i.key>1&&i.key<=9&&i.target.value!=="1"){i.preventDefault();i.target.value=`0${i.key}/`}else if(i.target.value==="0"&&i.key==="1"){i.preventDefault();i.target.value=`0${i.key}/`}else if(i.target.value==="1"&&i.key==="/"){i.preventDefault();i.target.value=`01/`}else if(i.target.value==="1"&&i.key>=0){i.preventDefault();i.target.value=`1${i.key}/`}}else if(i.target.value.length===4){if(i.key>=0){i.preventDefault();i.target.value=`${i.target.value}${i.key}/`}}if(i.key==="Backspace"){const M=i.target.value[i.target.selectionStart-1];if(M==="/"&&t.value.length>6){i.preventDefault();t.selectionStart=t.selectionEnd=t.value.length;t.focus()}else if(M==="/"&&t.value.length<6){t.focus();t.value=t.value.slice(0,2)}}};const l="MASTERCARD";const y="VISA";const h={2:l,4:y,5:l};const m=i=>h[i.charAt(0)]||null;const L=[31,29,31,30,31,30,31,31,30,31,30,31];const p=(i,t)=>{const M=parseInt(i);return M<=12&&t<=L[M-1]};const O=i=>{const t=new RegExp("^(0[1-9]|1[0-2])/?([0-9]{2})/?([0-9]{4})$");const M=t.test(i);return M};const z="Birth date cannot be a future date";const b="Card has already expired";const k="Enter a valid card number";const S="Enter a valid CVV";const C="Enter a valid date format (MM/YY)";const U="Enter a valid date format (MM/DD/YYYY)";const v="Enter a valid Visa or Mastercard card number";const w="Enter a valid ZIP code";const f="MASTERCARD";const Q="VISA";const Y=".add-linked-account-container{border-radius:var(--components-universal-borderRadius);padding:var(--components-universal-padding);background-color:var(--components-universal-backgroundColor);border:var(--components-universal-borderWidth) solid var(--components-universal-borderColor);overflow:hidden}.add-linked-account{background:var(--styles-background-surfacePrimaryColor)}.mq-input .input-container.cardnumber:before{content:'';width:1.5rem;height:1.5rem;position:absolute;transition:background-image var(--animation-animationDuration-duration150);background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIwIDVINEMyLjg5NTQzIDUgMiA1Ljg5NTQzIDIgN1YxN0MyIDE4LjEwNDYgMi44OTU0MyAxOSA0IDE5SDIwQzIxLjEwNDYgMTkgMjIgMTguMTA0NiAyMiAxN1Y3QzIyIDUuODk1NDMgMjEuMTA0NiA1IDIwIDVaIiBzdHJva2U9IiNBNkE2QTYiIHN0cm9rZS13aWR0aD0iMS41IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPHBhdGggZD0iTTIgMTBIMjIiIHN0cm9rZT0iI0E2QTZBNiIgc3Ryb2tlLXdpZHRoPSIxLjUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8L3N2Zz4K);right:var(--spacing-spacing300)}.mq-input .input-container.cardnumber.mastercard:before{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE2IDVDMTUuMDgwNyA1IDE0LjE3MDUgNS4xODEwNiAxMy4zMjEyIDUuNTMyODRDMTIuNDcxOSA1Ljg4NDYzIDExLjcwMDMgNi40MDAyNCAxMS4wNTAzIDcuMDUwMjVDMTAuNDAwMiA3LjcwMDI2IDkuODg0NjMgOC40NzE5NCA5LjUzMjg0IDkuMzIxMjJDOS4xODEwNiAxMC4xNzA1IDkgMTEuMDgwNyA5IDEyQzkgMTIuOTE5MyA5LjE4MTA2IDEzLjgyOTUgOS41MzI4NCAxNC42Nzg4QzkuODg0NjMgMTUuNTI4MSAxMC40MDAyIDE2LjI5OTcgMTEuMDUwMyAxNi45NDk3QzExLjcwMDMgMTcuNTk5OCAxMi40NzE5IDE4LjExNTQgMTMuMzIxMiAxOC40NjcyQzE0LjE3MDUgMTguODE4OSAxNS4wODA3IDE5IDE2IDE5QzE2LjkxOTMgMTkgMTcuODI5NSAxOC44MTg5IDE4LjY3ODggMTguNDY3MkMxOS41MjgxIDE4LjExNTQgMjAuMjk5NyAxNy41OTk4IDIwLjk0OTcgMTYuOTQ5N0MyMS41OTk4IDE2LjI5OTcgMjIuMTE1NCAxNS41MjgxIDIyLjQ2NzIgMTQuNjc4OEMyMi44MTg5IDEzLjgyOTUgMjMgMTIuOTE5MyAyMyAxMkMyMyAxMS4wODA3IDIyLjgxODkgMTAuMTcwNSAyMi40NjcyIDkuMzIxMjJDMjIuMTE1NCA4LjQ3MTk0IDIxLjU5OTggNy43MDAyNiAyMC45NDk3IDcuMDUwMjVDMjAuMjk5NyA2LjQwMDI0IDE5LjUyODEgNS44ODQ2MyAxOC42Nzg4IDUuNTMyODRDMTcuODI5NSA1LjE4MTA2IDE2LjkxOTMgNSAxNiA1WiIgZmlsbD0iI0ZGOTgwMCIvPgo8cGF0aCBkPSJNOCA1QzcuMDgwNzUgNSA2LjE3MDUgNS4xODEwNiA1LjMyMTIyIDUuNTMyODRDNC40NzE5NCA1Ljg4NDYzIDMuNzAwMjYgNi40MDAyNCAzLjA1MDI1IDcuMDUwMjVDMi40MDAyNCA3LjcwMDI2IDEuODg0NjMgOC40NzE5NCAxLjUzMjg0IDkuMzIxMjJDMS4xODEwNiAxMC4xNzA1IDEgMTEuMDgwNyAxIDEyQzEgMTIuOTE5MyAxLjE4MTA2IDEzLjgyOTUgMS41MzI4NCAxNC42Nzg4QzEuODg0NjMgMTUuNTI4MSAyLjQwMDI0IDE2LjI5OTcgMy4wNTAyNSAxNi45NDk3QzMuNzAwMjYgMTcuNTk5OCA0LjQ3MTk0IDE4LjExNTQgNS4zMjEyMiAxOC40NjcyQzYuMTcwNSAxOC44MTg5IDcuMDgwNzUgMTkgOCAxOUM4LjkxOTI1IDE5IDkuODI5NTEgMTguODE4OSAxMC42Nzg4IDE4LjQ2NzJDMTEuNTI4MSAxOC4xMTU0IDEyLjI5OTcgMTcuNTk5OCAxMi45NDk3IDE2Ljk0OTdDMTMuNTk5OCAxNi4yOTk3IDE0LjExNTQgMTUuNTI4MSAxNC40NjcyIDE0LjY3ODhDMTQuODE4OSAxMy44Mjk1IDE1IDEyLjkxOTMgMTUgMTJDMTUgMTEuMDgwNyAxNC44MTg5IDEwLjE3MDUgMTQuNDY3MiA5LjMyMTIyQzE0LjExNTQgOC40NzE5NCAxMy41OTk4IDcuNzAwMjYgMTIuOTQ5NyA3LjA1MDI1QzEyLjI5OTcgNi40MDAyNCAxMS41MjgxIDUuODg0NjMgMTAuNjc4OCA1LjUzMjg0QzkuODI5NTEgNS4xODEwNiA4LjkxOTI1IDUgOCA1WiIgZmlsbD0iI0Q1MDAwMCIvPgo8cGF0aCBkPSJNOSAxMkM5IDE0LjM3NzUgMTAuMTg4IDE2LjQ3NSAxMiAxNy43NEMxMy44MTIgMTYuNDc1IDE1IDE0LjM3NzUgMTUgMTJDMTUgOS42MjI1MSAxMy44MTIgNy41MjUwMSAxMiA2LjI2MDAxQzEwLjE4OCA3LjUyNTAxIDkgOS42MjI1MSA5IDEyWiIgZmlsbD0iI0ZGM0QwMCIvPgo8L3N2Zz4K)}.mq-input .input-container.cardnumber.visa:before{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIyLjUgMTcuNUMyMi41IDE4LjYwNDUgMjEuNjA0NSAxOS41IDIwLjUgMTkuNUgzLjVDMi4zOTU1IDE5LjUgMS41IDE4LjYwNDUgMS41IDE3LjVWNi41QzEuNSA1LjM5NTUgMi4zOTU1IDQuNSAzLjUgNC41SDIwLjVDMjEuNjA0NSA0LjUgMjIuNSA1LjM5NTUgMjIuNSA2LjVWMTcuNVoiIGZpbGw9IiMxNTY1QzAiLz4KPHBhdGggZD0iTTcuNTkyNSA5LjUwMDAxTDYuMjc5NSAxMy40MTZDNi4yNzk1IDEzLjQxNiA1Ljk0NiAxMS43NTk1IDUuOTEzIDExLjU1MTVDNS4xNjU1IDkuODQ2MDEgNC4wNjI1IDkuOTQxMDEgNC4wNjI1IDkuOTQxMDFMNS4zNjI1IDE1VjE0Ljk5OUg2Ljk0M0w5LjEyODUgOS41MDAwMUg3LjU5MjVaTTguODQ0IDE1SDEwLjI3OTVMMTEuMTQ3NSA5LjUwMDAxSDkuNjk0TDguODQ0IDE1Wk0xOS4wMDM1IDkuNTAwMDFIMTcuNDkzTDE1LjEzOCAxNUgxNi41NjRMMTYuODU4IDE0LjIxNDVIMTguNjU2TDE4LjgwOSAxNUgyMC4xMTU1TDE5LjAwMzUgOS41MDAwMVpNMTcuMjU2IDEzLjE2NEwxOC4wMzc1IDExLjA4NTVMMTguNDQ2NSAxMy4xNjRIMTcuMjU2Wk0xMy4xODQgMTEuMTAzQzEzLjE4NCAxMC44IDEzLjQzMyAxMC41NzQ1IDE0LjE0NyAxMC41NzQ1QzE0LjYxMSAxMC41NzQ1IDE1LjE0MjUgMTAuOTExNSAxNS4xNDI1IDEwLjkxMTVMMTUuMzc1NSA5Ljc1NzAxQzE1LjM3NTUgOS43NTcwMSAxNC42OTY1IDkuNDk5NTEgMTQuMDMgOS40OTk1MUMxMi41MjA1IDkuNDk5NTEgMTEuNzQyIDEwLjIyMTUgMTEuNzQyIDExLjEzNTVDMTEuNzQyIDEyLjc4ODUgMTMuNzMxNSAxMi41NjIgMTMuNzMxNSAxMy40MTFDMTMuNzMxNSAxMy41NTY1IDEzLjYxNiAxMy44OTMgMTIuNzg3NSAxMy44OTNDMTEuOTU2NSAxMy44OTMgMTEuNDA4IDEzLjU4ODUgMTEuNDA4IDEzLjU4ODVMMTEuMTYwNSAxNC42OTY1QzExLjE2MDUgMTQuNjk2NSAxMS42OTIgMTQuOTk5NSAxMi43MTkgMTQuOTk5NUMxMy43NDg1IDE0Ljk5OTUgMTUuMTc2NSAxNC4yMjk1IDE1LjE3NjUgMTMuMTIzNUMxNS4xNzY1IDExLjc5MyAxMy4xODQgMTEuNjk3IDEzLjE4NCAxMS4xMDNaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNi4xMDU3MSAxMi40NzI1TDUuNjIyNzEgMTAuMDk4NUM1LjYyMjcxIDEwLjA5ODUgNS40MDQyMSA5LjU4Mzk4IDQuODM2MjEgOS41ODM5OEM0LjI2ODIxIDkuNTgzOTggMi42MTYyMSA5LjU4Mzk4IDIuNjE2MjEgOS41ODM5OEMyLjYxNjIxIDkuNTgzOTggNS40NDY3MSAxMC40MiA2LjEwNTcxIDEyLjQ3MjVaIiBmaWxsPSIjRkZDMTA3Ii8+Cjwvc3ZnPgo=)}.add-linked-account-actions mq-button button{margin-left:auto}.folding-input-container{display:flex;flex-direction:row;gap:var(--spacing-spacing400)}@media (max-width: 575px){.add-linked-account-actions .mq-button{min-width:auto;width:100%}.folding-input-container{flex-direction:column}}";const Z=Y;const V=class{constructor(M){i(this,M);this.mqLinkExternalCardLoadCompleted=t(this,"mqLinkExternalCardLoadCompleted",7);this.mqLinkExternalCardActionTriggered=t(this,"mqLinkExternalCardActionTriggered",7);this.mqLinkExternalCardActionCompleted=t(this,"mqLinkExternalCardActionCompleted",7);this.addLinkedAccount=async i=>{var t;this.mqLinkExternalCardActionTriggered.emit({type:j.LINK_ACCOUNT});i.preventDefault();this.isLoading=true;const{cardNumber:M,expirationMonth:s,expirationYear:o,cvv:n,dobDate:a,dobMonth:e,dobYear:c,zipCode:D}=this.getAddLinkedAccountInputs();const r=(t=M===null||M===void 0?void 0:M.value)===null||t===void 0?void 0:t.replace(/ /g,"");const I=`${s}${o.substring(2)}`;const g=`${c}-${e}-${a}`;const d=u.get(N);try{await d.execute(r,I,n.value,g,D.value);this.handleAddLinkedAccountSuccess();T.PullFromCard.linkCard()}catch(i){this.handleAddLinkedAccountError(i);T.PullFromCard.Exception(i.message)}finally{this.isLoading=false}};this.getAddLinkedAccountInputs=()=>{var i,t;const M=this.el.shadowRoot;const s=M.querySelector("input[name='cardnumber']");const o=M.querySelector(".input-container.cardnumber");const n=M.querySelector("input[name='cvv']");const a=M.querySelector("input[name='dob']");const e=((i=a===null||a===void 0?void 0:a.value)===null||i===void 0?void 0:i.split("/"))||[];const c=e[0];const D=e[1];const r=e[2];const u=M.querySelector("input[name='expiry']");const N=((t=u===null||u===void 0?void 0:u.value)===null||t===void 0?void 0:t.split("/"))||[];const I=N[0];const g="20"+N[1];const T=M.querySelector("input[name='zipcode']");return{cardNumber:s,cardNumberContainer:o,cvv:n,dob:a,dobMonth:c,dobDate:D,dobYear:r,expiry:u,expirationMonth:I,expirationYear:g,zipCode:T}};this.limitInputToNumbers=i=>{a(i)};this.handleCardNumberEvent=i=>{const t=i.target.value;const{cardNumberContainer:M}=this.getAddLinkedAccountInputs();M.classList.remove("visa");M.classList.remove("mastercard");if(i.type==="focusout"&&t.length<19){this.cardNumberError=k}else if(!m(t)){this.cardNumberError=v}else if(m(t)===f){this.cardNumberError="";M.classList.add("mastercard")}else if(m(t)===Q){this.cardNumberError="";M.classList.add("visa")}const{cardNumber:s}=this.getAddLinkedAccountInputs();x(i,s)};this.handleExpirationKeyDown=i=>{const{expiry:t}=this.getAddLinkedAccountInputs();e(i,t)};this.handleExpirationEvent=i=>{const t=i.target.value;const{expirationMonth:M,expirationYear:s}=this.getAddLinkedAccountInputs();if(i.type==="focusout"&&t.length<5||parseInt(M)>12){this.expiryError=C}else if(t.length===5&&!c(M,s)){this.expiryError=b}else{this.expiryError=""}};this.handleCvvEvent=i=>{const t=i.target.value;const M=i.type==="focusout"&&i.target.name==="cvv";if(M&&!D(t)){this.cvvError=S}else{this.cvvError=""}};this.handleZipCodeEvent=i=>{const t=i.target.value;if(i.type==="focusout"&&t.length<5){this.zipCodeError=w}else{this.zipCodeError=""}};this.handleDateOfBirthKeyDown=i=>{const{dob:t}=this.getAddLinkedAccountInputs();E(i,t)};this.handleDateOfBirthEvent=i=>{const t=i.target.value;const{dobMonth:M,dobDate:s,dobYear:o}=this.getAddLinkedAccountInputs();if(i.type==="focusout"&&t.length<10){this.dobError=U}else if(t.length===10&&!A(M,s,o)){this.dobError=z}else if(!p(M,s)){this.dobError=U}else{this.dobError=""}};this.handleLinkCardButtonValidator=()=>{const{cardNumber:i,cvv:t,dob:M,dobDate:s,dobMonth:o,dobYear:n,expiry:a,expirationMonth:e,expirationYear:u,zipCode:N}=this.getAddLinkedAccountInputs();if(!t.value||!a.value||i.value.length<19||M.value.length<10||N.value.length<5||!A(o,s,n)||!c(e,u)||!p(o,s)||!D(t.value)||!O(M.value)||!r(a.value)){this.isLinkCardDisabled=true}else{this.isLinkCardDisabled=false}};this.showTitle=true;this.showDescription=true;this.cardNumberError="";this.cvvError="";this.expiryError="";this.dobError="";this.zipCodeError="";this.isLoading=false;this.isLinkCardDisabled=true;this.errorMessage=null}connectedCallback(){I((i=>{i&&setTimeout((()=>this.mqLinkExternalCardLoadCompleted.emit({status:d.SUCCESS})),0)}))}handleAddLinkedAccountSuccess(){this.mqLinkExternalCardActionCompleted.emit({type:j.LINK_ACCOUNT,status:d.SUCCESS})}handleAddLinkedAccountError(i){var t;const M=(t=i===null||i===void 0?void 0:i.originalError)===null||t===void 0?void 0:t.message;this.errorMessage=M;this.mqLinkExternalCardActionCompleted.emit({type:j.LINK_ACCOUNT,status:d.ERROR,error:{code:M}})}render(){if(!g.mqCuiReady){return null}return M(o,null,M("theme-provider",null,M("div",{class:"add-linked-account-container"},M("div",{class:"add-linked-account"},this.showTitle&&M(s,null,M("mq-text",{type:"heading"},"Link your debit or prepaid card"),M("mq-vspacer",{factor:2})),this.showDescription&&M(s,null,M("mq-text",{colorType:"secondary"},"We accept Visa and Mastercard cards."),M("mq-vspacer",{factor:5})),this.errorMessage&&M(s,null,M("mq-alert",{type:"error"},this.errorMessage),M("mq-vspacer",{factor:5})),M("form",{class:"add-linked-account-form",onSubmit:this.addLinkedAccount,"accept-charset":"UTF-8",autocomplete:"off"},M("mq-input",{"auto-focus":true,name:"cardnumber",label:"Card number",maxlength:"19",disabled:this.isLoading,onFocusout:this.handleCardNumberEvent,onInput:this.handleCardNumberEvent,onKeyPress:this.limitInputToNumbers,onKeyUp:this.handleLinkCardButtonValidator,error:this.cardNumberError}),M("mq-vspacer",{factor:4}),M("flex-container",{gap:"var(--spacing-spacing400)"},M("mq-input",{name:"expiry",label:"Expiration date (MM/YY)",maxlength:"5",disabled:this.isLoading,onFocusout:this.handleExpirationEvent,onInput:this.handleExpirationEvent,onKeyDown:this.handleExpirationKeyDown,onKeyPress:this.limitInputToNumbers,onKeyUp:this.handleLinkCardButtonValidator,error:this.expiryError}),M("mq-input",{name:"cvv",label:M("cvv-tooltip",null),maxlength:"3",disabled:this.isLoading,onFocusout:this.handleCvvEvent,onInput:this.handleCvvEvent,onKeyPress:this.limitInputToNumbers,onKeyUp:this.handleLinkCardButtonValidator,error:this.cvvError})),M("mq-vspacer",{factor:4}),M("div",{class:"folding-input-container"},M("mq-input",{name:"zipcode",label:"ZIP code",maxlength:"5",disabled:this.isLoading,onFocusout:this.handleZipCodeEvent,onInput:this.handleZipCodeEvent,onKeyPress:this.limitInputToNumbers,onKeyUp:this.handleLinkCardButtonValidator,error:this.zipCodeError}),M("mq-input",{name:"dob",label:"Date of birth (MM/DD/YYYY)",maxlength:"10",disabled:this.isLoading,onFocusout:this.handleDateOfBirthEvent,onInput:this.handleDateOfBirthEvent,onKeyDown:this.handleDateOfBirthKeyDown,onKeyPress:this.limitInputToNumbers,onKeyUp:this.handleLinkCardButtonValidator,error:this.dobError})),M("mq-vspacer",{factor:4}),M("flex-container",{alignItems:"center",gap:".5rem"},M("mq-icon",{name:"lock",strokeColor:"var(--styles-icons-iconDefaultColor)",backgroundColor:"transparent"}),M("mq-text",{type:"caption"},"Your data is securely encrypted")),M("mq-vspacer",{factor:7}),M("div",{class:"add-linked-account-actions"},M("mq-button",{kind:"primary",label:"Link card",type:"submit",loading:this.isLoading,disabled:this.isLinkCardDisabled,onClick:this.addLinkedAccount})))))))}static get assetsDirs(){return["public"]}get el(){return n(this)}};V.style=Z;export{V as add_linked_account};
//# sourceMappingURL=p-44559a29.entry.js.map