/**
 * Cardholder UI Web Components v0.22.0
 * (c) 2024 Marqeta
 * @license MIT
 */
import{r as t,k as i,i as a,F as s,H as e,j as r}from"./p-18a64bdb.js";import{c as o,w as n}from"./p-675e89df.js";import{a as c}from"./p-b0df58a1.js";import{v as d,a as l,b as h,f as p}from"./p-4e66535e.js";import{A as m}from"./p-52af63d3.js";import{o as u,m as v}from"./p-c7bc8265.js";import{C as f}from"./p-cb5bbf71.js";import{A as g}from"./p-d8508f4c.js";import"./p-0462f723.js";const x=".activate-card-container{border-radius:var(--components-universal-borderRadius);padding:var(--components-universal-padding);background-color:var(--components-universal-backgroundColor);border:var(--components-universal-borderWidth) solid var(--components-universal-borderColor);overflow:hidden}.mq-activate-card-header{display:flex;align-items:center;align-self:stretch;gap:var(--spacing-spacing200);padding-bottom:var(--spacing-spacing600);background-color:var(--styles-background-surfacePrimaryColor)}.activate-card-body{background-color:var(--styles-background-surfacePrimaryColor)}.activate-card-form-container{display:flex;flex-direction:column;flex:1;justify-content:space-between;gap:var(--spacing-spacing400);margin-bottom:var(--spacing-spacing600)}@media (min-width: 480px){.activate-card-form-container{flex-direction:row;}}@media (max-width: 480px){.activate-card-form-container{flex-direction:column;gap:var(--spacing-spacing600)}}";const y=x;var b;(function(t){t["CARDS_INVALID_CARD_DETAILS"]="Your card information could not be verified. Try again or contact customer support for assistance.";t["DEFAULT"]="There was a problem activating your card. Please contact customer support for assistance."})(b||(b={}));const C=class{constructor(a){t(this,a);this.mqActivateCardLoadCompleted=i(this,"mqActivateCardLoadCompleted",7);this.mqActivateCardActionTriggered=i(this,"mqActivateCardActionTriggered",7);this.mqActivateCardActionCompleted=i(this,"mqActivateCardActionCompleted",7);this.activateCard=async t=>{this.mqActivateCardActionTriggered.emit({type:g.ACTIVATE,data:{cardToken:this.cardToken}});t.preventDefault();this.isLoading=true;const i=t.target.form;const a=i.elements["expiry"].value.replace("/","");const s=i.elements["cvv"].value;const e=o.get(n);try{await e.execute(this.cardToken,s,a);this.handleActivationSuccess()}catch(t){this.handleActivationError(t)}finally{this.isLoading=false}};this.getActivateCardInputs=()=>{const t=this.el.shadowRoot;const i=t.querySelector("input[name='cvv']");const a=t.querySelector("input[name='expiry']");const s=a.value.split("/");const e=s[0];const r="20"+s[1];return{cvv:i,expiry:a,expirationMonth:e,expirationYear:r}};this.handleCardInputsOnKeyPress=t=>{c(t)};this.handleCvvOnFocusOut=t=>{const i=t.target.value;if(i===""){this.cvvError="Enter CVV"}else if(!d(i)){this.cvvError="Invalid CVV"}else{this.cvvError=""}};this.handleCvvOnInput=()=>{const{cvv:t}=this.getActivateCardInputs();if(t.value){this.cvvError=""}};this.handleExpirationDateOnFocusOut=t=>{const i=t.target.value;if(i===""){this.expiryError="Enter expiration date"}else if(!l(i)){this.expiryError="Invalid expiration date"}};this.handleExpirationDateOnInput=t=>{const i=t.target.value;const{expirationMonth:a,expirationYear:s}=this.getActivateCardInputs();if(i.length===5&&!h(a,s)){this.expiryError="Invalid expiration date"}else{this.expiryError=""}};this.handleExpirationDateOnKeyDown=t=>{const{expiry:i}=this.getActivateCardInputs();p(t,i)};this.handleSubmitValidator=()=>{const{cvv:t,expiry:i,expirationMonth:a,expirationYear:s}=this.getActivateCardInputs();if(!t.value||!i.value){this.isSubmitDisabled=true}else if(!l(i.value)||!d(t.value)||!h(a,s)){this.isSubmitDisabled=true}else{this.isSubmitDisabled=false}};this.cardToken=undefined;this.showDescription=undefined;this.showTitle=undefined;this.cvvError="";this.expiryError="";this.isLoading=false;this.isSubmitDisabled=true;this.errorMessage=null;this.theme=null}componentDidLoad(){u((t=>{t&&setTimeout((()=>this.mqActivateCardLoadCompleted.emit({status:f.SUCCESS,data:{cardToken:this.cardToken}})),0)}))}handleActivationSuccess(){m.CardManagement.cardActivationSuccess();this.mqActivateCardActionCompleted.emit({type:g.ACTIVATE,status:f.SUCCESS,data:{cardToken:this.cardToken}})}handleActivationError(t){var i;m.CardManagement.cardActivationError();const a=(i=t===null||t===void 0?void 0:t.originalError)===null||i===void 0?void 0:i.message;this.errorMessage=b[a]||b.DEFAULT;this.mqActivateCardActionCompleted.emit({type:g.ACTIVATE,status:f.ERROR,error:{code:a,message:this.errorMessage},data:{cardToken:this.cardToken}})}render(){if(!this.cardToken||!v.mqCuiReady){return null}return a(e,null,a("theme-provider",null,a("div",{class:"activate-card-container"},(this.showTitle||this.showDescription)&&a("div",{class:"mq-activate-card-header"},a("flex-container",{flex:"initial",flexDirection:"column",justifyContent:"center",alignItems:"flex-start",gap:"var(--spacing-spacing200)"},this.showTitle&&a("mq-text",{type:"heading"},"Activate card"),this.showDescription&&a("mq-text",{styleOverride:{color:"var(--styles-text-textSecondaryColor)"}},"Enter your card details below."))),a("div",{class:"mq-activate-card-body"},a("div",{class:"activate-card-body"},a("form",{class:"activate-card-form",onSubmit:this.activateCard,"accept-charset":"UTF-8",autocomplete:"off"},this.errorMessage&&a(s,null,a("mq-alert",{type:"error"},this.errorMessage),a("mq-vspacer",{factor:5})),a("div",{class:"activate-card-form-container"},a("mq-input",{"auto-focus":true,name:"expiry",label:"Expiration date (MM/YY)",maxlength:"5",disabled:this.isLoading,onFocusout:this.handleExpirationDateOnFocusOut,onInput:this.handleExpirationDateOnInput,onKeyDown:this.handleExpirationDateOnKeyDown,onKeyPress:this.handleCardInputsOnKeyPress,onKeyUp:this.handleSubmitValidator,error:this.expiryError}),a("mq-input",{name:"cvv",label:a("cvv-tooltip",null),maxlength:"3",disabled:this.isLoading,onFocusout:this.handleCvvOnFocusOut,onInput:this.handleCvvOnInput,onKeyPress:this.handleCardInputsOnKeyPress,onKeyUp:this.handleSubmitValidator,error:this.cvvError})),a("flex-container",{flexDirection:"row",justifyContent:"flex-end"},a("mq-button",{kind:"primary",label:"Activate card",type:"submit",small:true,loading:this.isLoading,disabled:this.isSubmitDisabled,onClick:this.activateCard}))))))))}get el(){return r(this)}};C.style=y;export{C as activate_card};
//# sourceMappingURL=p-cad81c02.entry.js.map