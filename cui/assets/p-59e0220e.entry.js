/**
 * Cardholder UI Web Components v0.22.0
 * (c) 2024 Marqeta
 * @license MIT
 */
import{r as t,k as s,i as e,F as i,H as r,j as n}from"./p-18a64bdb.js";import{o,m as a}from"./p-c7bc8265.js";import{a as d}from"./p-b0df58a1.js";import{c as h,O as l,a9 as c}from"./p-675e89df.js";import{A as u}from"./p-52af63d3.js";import{g as f}from"./p-324125bc.js";import{B as m}from"./p-3b5975cd.js";import{H as p,C as b}from"./p-cb5bbf71.js";import"./p-0462f723.js";import"./p-bc4f08b6.js";const y=t=>parseFloat(t.replace("$","").replace(/,/g,""));const v=t=>`$${t?t.toString().replace(/((\d{1,3}))(?=\d{3})/g,"$1,"):"0"}`;var g;(function(t){t["ADD_FUNDS"]="ADD_FUNDS"})(g||(g={}));const q="An error occurred while processing your request. Try again later.";const x=".mq-transfer-funds-container{border-radius:var(--components-universal-borderRadius);padding:var(--components-universal-padding);background-color:var(--components-universal-backgroundColor);border:var(--components-universal-borderWidth) solid var(--components-universal-borderColor);overflow:hidden}.mq-transfer-funds{background:var(--styles-background-surfacePrimaryColor)}.mq-transfer-funds-default{display:flex;flex-direction:column;align-items:center}.mq-transfer-funds-input{width:100%;text-align:center;font-size:4rem;border:none;outline:none;color:var(--typography-number-numberTitleFontColor);font-weight:var(--typography-hero-defaultHeroFontWeight);letter-spacing:var(--typography-number-numberLetterSpacing);line-height:var(--typography-number-numberLineHeight);height:4.86rem;transition:font-size var(--animation-animationDuration-duration150);background-color:transparent}.mq-transfer-funds-input.smaller-font{font-size:2.25rem}.mq-transfer-funds-phase-two{padding:var(--spacing-spacing600);text-align:center}.mq-transfer-funds-phase-two-icon{width:4rem;height:4rem;border-radius:100%;margin:0 auto;display:flex;align-items:center;justify-content:center;border:5px solid var(--colors-primary-primary500);background-color:var(--colors-primary-primary50)}.mq-transfer-funds-select-source-container{border:var(--styles-border-borderWidth) solid var(--styles-border-borderDefaultColor);border-radius:var(--borderRadius-radius200)}.mq-transfer-funds-select-source-container-header,.mq-transfer-funds-source-item{padding:var(--spacing-spacing400)}.mq-transfer-funds-select-source-container .mq-list-item{border-bottom:var(--styles-border-borderWidth) solid var(--styles-border-borderDefaultColor)}.mq-transfer-funds-select-source-container mq-list-item:last-of-type .mq-list-item{border-bottom:none}.mq-transfer-funds mq-button{width:100%}.mq-transfer-funds mq-button button{margin-left:auto;margin-right:auto}.large-screen-bottom-buttons{display:flex;flex-direction:row-reverse;justify-content:space-between}.mq-transfer-funds .large-screen-bottom-buttons mq-button{width:auto}.mq-transfer-funds .large-screen-bottom-buttons mq-button button{margin:0}";const C=x;var w;(function(t){t["MONEY_MOVEMENT_TXN_LIMIT_ERROR"]="This funds transfer exceeds the limit for your account. Try again with a smaller amount.";t["MONEY_MOVEMENT_DAILY_LIMIT_ERROR"]="Your funds transfer exceeds the daily limit. Try again with a smaller amount, or wait until your limit resets.";t["MONEY_MOVEMENT_INTERNAL_SERVER_ERROR"]="We are unable to process your deposit at this time. Try again or contact customer support."})(w||(w={}));var $;(function(t){t["MONEY_MOVEMENT_TXN_LIMIT_ERROR"]="Per-transaction limit exceeded";t["MONEY_MOVEMENT_DAILY_LIMIT_ERROR"]="Daily limit exceeded";t["MONEY_MOVEMENT_INTERNAL_SERVER_ERROR"]="Deposit failed"})($||($={}));const k=["MASTERCARD","VISA","DISCOVER","PULSE"];const T=class{constructor(r){t(this,r);this.mqTransferFundsLoadInitiated=s(this,"mqTransferFundsLoadInitiated",7);this.mqTransferFundsLoadCompleted=s(this,"mqTransferFundsLoadCompleted",7);this.mqTransferFundsActionTriggered=s(this,"mqTransferFundsActionTriggered",7);this.mqTransferFundsActionCompleted=s(this,"mqTransferFundsActionCompleted",7);this.mqTransferFundsActionHook=s(this,"mqTransferFundsActionHook",7);this.addFundsInput=null;this.isMobile=true;this.handleClose=(t=false)=>{if(t){this.mqTransferFundsActionHook.emit({type:p.SUCCESS_DONE})}else{this.mqTransferFundsActionHook.emit({type:p.ERROR_DONE})}};this.handleSourceCardsRequest=async()=>{try{this.isLoading=true;const t=h.get(l);const s=await t.execute();s.data.forEach((t=>{this.sources.push(t)}));if(this.sources.length){this.externalCardToken=this.sources[0].token;this.mqTransferFundsLoadCompleted.emit({status:b.SUCCESS})}}catch(t){console.log("Error getting source cards:",t);this.mqTransferFundsLoadCompleted.emit({status:b.ERROR,error:{code:"SOURCE_CARDS_LOAD_ERROR"}})}finally{this.isLoading=false}};this.initiateFunding=async()=>{var t;this.mqTransferFundsActionTriggered.emit({type:g.ADD_FUNDS,data:{externalCardToken:this.externalCardToken,amount:this.amountToTransfer}});const s=h.get(c);this.isSubmitButtonEnabled=false;this.isSubmitButtonLoading=true;this.showSuccess=false;try{await s.execute(this.externalCardToken,this.amountToTransfer.toFixed(2),"USD","");this.mqTransferFundsActionCompleted.emit({type:g.ADD_FUNDS,status:b.SUCCESS});this.showSuccess=true;u.PullFromCard.addMoney()}catch(s){this.isSubmitButtonLoading=false;const e=((t=s===null||s===void 0?void 0:s.originalError)===null||t===void 0?void 0:t.message)||"MONEY_MOVEMENT_INTERNAL_SERVER_ERROR";this.errorMessage=w[e];this.errorMessageHeader=$[e];this.showError=true;this.mqTransferFundsActionCompleted.emit({type:g.ADD_FUNDS,status:b.ERROR,error:{code:e||"TRANSFER_FUNDS_ERROR",message:this.errorMessage||q}});u.PullFromCard.Exception(e)}};this.renderErrorScreen=()=>e("mq-end-card",{icon:"circle-error",titleText:this.errorMessageHeader,subtitleText:this.errorMessage,buttonSize:this.isMobile?m.large:m.large,onMqEndCardButtonClicked:()=>this.handleClose(false),showUniversalPadding:false});this.renderSuccessScreen=()=>{const t=e("div",{class:"mq-transfer-funds-phase-two-icon"},e("mq-icon",{strokeWidth:"2",name:"txn-type-deposit-icon",backgroundColor:"transparent",strokeColor:"var(--styles-icons-iconBrandColor)",size:"2rem"}));return e("mq-end-card",{icon:t,showAnimation:true,titleText:`You added ${v(this.amountToTransfer.toFixed(2))} to your account`,buttonSize:f(this.el)==="xs"?m.large:m.small,onMqEndCardButtonClicked:()=>this.handleClose(true),showUniversalPadding:false})};this.renderSelectSourceItem=(t,s)=>e("mq-list-item",{key:s,icon:`${k.indexOf(t.network.toUpperCase())>=0?t.network.toLowerCase():"default"}-network-icon`,titleKey:`${t.funding_source_name} (${t.last_four})`,subheadingKey:e("div",null,e("mq-text",{colorType:"secondary"},"Instant deposit")),showRadioAction:true,itemToken:t.token,radioValue:this.externalCardToken,handleListItemAction:t=>{this.externalCardToken=t}});this.renderSelectSourceScreen=()=>e("div",{class:"mq-transfer-funds-select-source"},this.showTitle&&e(i,null,e("mq-text",{type:"heading"},"Review your deposit"),e("mq-vspacer",{factor:5})),e("div",{class:"mq-transfer-funds-select-source-container"},e("div",{class:"mq-transfer-funds-select-source-container-header"},e("mq-text",{type:"number",styleOverride:{fontWeight:"var(--typography-hero-defaultHeroFontWeight)",display:"block"}},v(this.amountToTransfer.toFixed(2))))),e("mq-vspacer",{factor:5}),e("div",{class:"mq-transfer-funds-select-source-container"},e("div",{class:"mq-transfer-funds-select-source-container-header"},e("mq-text",{type:"label",small:true,colorType:"brand"},"SELECT ACCOUNT")),this.sources.map(((t,s)=>this.renderSelectSourceItem(t,s)))),e("mq-vspacer",{factor:7}),e("div",{class:this.isMobile?"":"large-screen-bottom-buttons"},e("mq-button",{disabled:!this.externalCardToken,fullWidth:this.isMobile,kind:"primary",onClick:this.initiateFunding,loading:this.isSubmitButtonLoading},this.isSubmitButtonLoading?"":`Add ${v(this.amountToTransfer.toFixed(2))}`),this.isMobile&&e("mq-vspacer",{factor:3}),e("mq-button",{fullWidth:this.isMobile,kind:"secondary",onClick:()=>{this.showSelectSource=false}},"Back")));this.handleAmountKeyPress=t=>{const s=t.target.value.split(".");if(s.length>1&&t.key==="."){t.preventDefault()}else if(s.length>1&&s[1].length>=2&&t.target.selectionStart>t.target.value.indexOf(".")){t.preventDefault()}else if(y(t.target.value+t.key)>=1e5){t.preventDefault()}else if(t.which!==46){d(t)}else if(t.which===46&&t.target.value.indexOf(".")>=0){t.preventDefault()}};this.blurAddFunds=()=>{if(this.addFundsInput.value==="$"||this.addFundsInput.value==="$0"){this.addFundsInput.value="$0";this.isSubmitButtonEnabled=false}};this.focusOnAddFunds=t=>{var s;(s=t===null||t===void 0?void 0:t.target)===null||s===void 0?void 0:s.setSelectionRange(-1,-1)};this.handleAmountUpdate=t=>{const s=t.target.selectionStart;const e=t.target.value.length;if(t.target.value.indexOf("$")>0||t.target.value.indexOf("$")<0){this.addFundsInput.value=`$${t.target.value.replace("$","")}`}if(t.target.value===""){this.addFundsInput.value="$0"}if(this.addFundsInput.value.charAt(1)==="0"&&this.addFundsInput.value.charAt(2)!=="."){this.addFundsInput.value=`$${this.addFundsInput.value.substring(2)}`}const i=this.addFundsInput.value.split(".");if(i[0]==="$"&&i[1]||this.addFundsInput.value==="$."){this.addFundsInput.value=`$0.${i[1]}`}if(this.addFundsInput.value.length>=7){this.addFundsInput.classList.add("smaller-font")}else{this.addFundsInput.classList.remove("smaller-font")}this.addFundsInput.selectionStart=this.addFundsInput.selectionEnd=s+this.addFundsInput.value.length-e;this.amountToTransfer=y(this.addFundsInput.value);this.isSubmitButtonEnabled=this.amountToTransfer>0};this.handleAmountKeyDown=t=>{if(t.key==="ArrowLeft"&&t.target.selectionStart===1){t.preventDefault()}};this.renderDefaultScreen=()=>{const t=this.sources.length===1;let s="Continue";if(t){this.cardNetwork=this.sources[0].network;this.cardLastFour=this.sources[0].last_four;s="Add money"}if(this.isLoading){return e("div",{class:"mq-transfer-funds-default"},e("mq-bone",{width:"132px",height:"48px"}),e("mq-vspacer",{factor:6}),e("mq-bone",{width:"245px",height:"24px"}),e("mq-vspacer",{factor:9}),e("mq-bone",{width:"342px",height:"44px"}))}else{return e("div",{class:"mq-transfer-funds-default"},e("input",{name:"addfunds",type:"text",class:"mq-transfer-funds-input",value:v(this.amountToTransfer),ref:t=>this.addFundsInput=t,onFocus:this.focusOnAddFunds,onBlur:this.blurAddFunds,onKeyPress:this.handleAmountKeyPress,onKeyDown:this.handleAmountKeyDown,onInput:this.handleAmountUpdate}),this.cardNetwork&&this.cardLastFour&&e(i,null,e("mq-vspacer",{factor:6}),e("mq-badge",{type:"brand",size:"medium",content:`From ${this.cardNetwork.charAt(0).toUpperCase()}${this.cardNetwork.substring(1).toLowerCase()} ${this.cardLastFour}`})),e("mq-vspacer",{factor:9}),e("mq-button",{fullWidth:this.isMobile,disabled:!this.isSubmitButtonEnabled,kind:"primary",onClick:()=>{t?this.initiateFunding():this.showSelectSource=true},loading:this.isSubmitButtonLoading},this.isSubmitButtonLoading?"":s))}};this.externalCardToken=undefined;this.cardNetwork=undefined;this.cardLastFour=undefined;this.showTitle=true;this.isLoading=true;this.isSubmitButtonLoading=false;this.isSubmitButtonEnabled=false;this.showSuccess=false;this.showError=false;this.showSelectSource=false;this.amountToTransfer=0;this.errorMessage="";this.errorMessageHeader="";this.sources=[]}connectedCallback(){this.mqTransferFundsLoadInitiated.emit();o((t=>{t&&this.handleSourceCardsRequest()}))}componentDidLoad(){this.isMobile=f(this.el)==="xs"}render(){if(!a.mqCuiReady){return null}return e(r,null,e("theme-provider",null,e("div",{class:"mq-transfer-funds-container"},e("div",{class:"mq-transfer-funds"},this.showError&&this.renderErrorScreen(),this.showSuccess&&this.renderSuccessScreen(),!this.showError&&!this.showSuccess&&this.showSelectSource&&this.renderSelectSourceScreen(),!this.showError&&!this.showSuccess&&!this.showSelectSource&&this.renderDefaultScreen()))))}get el(){return n(this)}};T.style=C;export{T as mq_transfer_funds};
//# sourceMappingURL=p-59e0220e.entry.js.map