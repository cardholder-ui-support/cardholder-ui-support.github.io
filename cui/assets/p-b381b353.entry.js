/**
 * Cardholder UI Web Components v0.22.0
 * (c) 2024 Marqeta
 * @license MIT
 */
import{e as t,r as i,k as e,i as s,F as a,d as r,H as n,j as c}from"./p-18a64bdb.js";import{c as o,D as l,E as d,B as h,z as m,F as u}from"./p-675e89df.js";import{m as p,g,b as v}from"./p-ac6d60ea.js";import{c as f}from"./p-ac7db7a1.js";import"./p-52af63d3.js";import{i as b}from"./p-fd1eb924.js";import{o as y,m as x}from"./p-c7bc8265.js";import"./p-0462f723.js";class k{connectedCallback(i){const e=o.get(l);if(e.execute()){t(window.marqeta.assetPath);if(i instanceof j){this.mockCardComponentV2(i)}}}mockCardComponentV2(t){t.card=p}}const w=".card-container{width:100%;padding:var(--spacing-spacing600);border-radius:var(--borderRadius-radius200);border:var(--styles-border-borderWidth) solid var(--colors-neutral-neutral200);background:var(--colors-neutral-white);box-sizing:border-box}div{box-sizing:border-box}.card-status-overlay{width:100%;position:absolute;top:0;left:0;height:100%;border-radius:8px;opacity:0.6;background:var(--colors-neutral-neutral200);z-index:1}.card-status-container{width:100%;position:absolute;top:0;left:0;height:100%;border-radius:8px;z-index:2;flex:1;justify-content:center;align-items:center;display:flex}.card-status-pill{border-radius:4px;gap:2px;display:flex;align-items:center;padding:2px 4px;background:var(--colors-neutral-neutral100);box-shadow:var(--elevation-elevation1)}.card-status-pill img{width:1rem}.card-comp-grid{display:grid;gap:1rem;grid-template-columns:auto 1fr}.buttons-grid-item{display:flex;justify-content:space-between}.card-view-grid-item{grid-row:span 3}.transact-summary-grid-item{display:flex;flex-direction:row;justify-content:space-between}.transact-summary-grid-item .summary{display:flex;flex-direction:column;justify-content:space-between;flex:1}@media (max-width: 480px){.card-container{width:auto;padding:var(--spacing-spacing400)}.card-comp-grid{display:grid;gap:var(--spacing-spacing400);grid-template-columns:auto 1fr}.card-view-grid-item{grid-row:span 1;zoom:0.3}.buttons-grid-item{grid-column:span 2}.transact-summary-grid-item{grid-column:span 2;display:flex;flex-direction:column}.transact-summary-grid-item .summary{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.transact-summary-grid-item::before{content:'';height:1px;background-color:var(--colors-neutral-neutral200);display:block;width:calc(100% + 2 * var(--spacing-spacing400));margin-bottom:var(--spacing-spacing300);position:relative;left:calc(var(--spacing-spacing400) * -1)}.card-status-container{zoom:3}}";const $=w;var q;(function(t){t["details"]="View card details";t["report"]="Report Lost/Stolen";t["lock"]="Lock card";t["unlock"]="Unlock card";t["setpin"]="Change PIN"})(q||(q={}));const C={[v.UNACTIVATED]:"Inactive",[v.SUSPENDED]:"Locked",[v.TERMINATED]:"Terminated"};const S={"font-weight":"600",color:"var(--colors-neutral-black)"};const j=class{constructor(t){i(this,t);this.mqComponentInit=e(this,"mqComponentInit",7);this.modal=document.querySelector("mq-modal");this.activateCard=document.querySelector("activate-card");this.loadEnvConfigVars=()=>{const t=o.get(d);const i=o.get(h);this.activeEnvName=t.execute();this.cuiApiBaseUrl=i.execute("CUI_API_BASE_URL")};this.initializeIframeListener=()=>{const t=o.get(h);const i=t.execute("CUI_API_BASE_URL");window.addEventListener("message",(async t=>{if(t.origin===i){switch(t.data.type){case"mqActivateCardSubmitSuccess":this.showActivateCardSuccessModal();break;case"mqActivateCardInvalidState":this.showActivateCardErrorModal();break;case"mqActivateCardDone":case"mqSetPinDone":case"revealPinClose":this.modal.hideModal();break;case"mqActivateCardSubmitError":this.modal.updateModalBodyHeight("300px");break;case"mqSetPinSubmitSuccess":this.showSetPinSuccessModal(t.data.payload);break;case"mqSetPinSubmitError":this.modal.updateModalBodyHeight("385px");break;default:console.log("Some event",t)}}}))};this.initializeModal=()=>{if(!this.modal){document.body.appendChild(document.createElement("mq-modal"));this.modal=document.querySelector("mq-modal")}};this.handleOptionSelected=t=>{const i=t.detail;switch(i){case q.details:{this.cardDetailsClick();break}case q.setpin:{this.showSetPinModal();break}case q.report:{this.reportCardClick();break}case q.lock:{this.transitioncard("SUSPENDED","Lock Card","Locking card","lockCard");break}case q.unlock:{this.transitioncard("ACTIVE","Unlock Card","Unlocking card","unlockCard");break}default:{alert("clicked an option that is not implemented")}}};this.loadCard=async()=>{try{const t=o.get(m);const i=await t.execute(this.cardToken);this.card=f(i)}catch(t){}};this.formatBaseSearchParams=()=>{const t=o.get(u);const i=[`card_token=${this.cardToken}`,`auth_token=${t.execute()}`,`theme_name=${this.themeName}`,`env_name=${this.activeEnvName}`];return i.join("&")};this.cardDetailsClick=()=>{var t,i,e,r,n;this.modal.showModal("Card details",s(a,null,s("flex-container",{justifyContent:"center",flex:"none"},s("card-view",{"cardholder-name":`${(i=(t=this.card)===null||t===void 0?void 0:t.user)===null||i===void 0?void 0:i.firstName} ${(r=(e=this.card)===null||e===void 0?void 0:e.user)===null||r===void 0?void 0:r.lastName}`,"card-number":`••••${(n=this.card)===null||n===void 0?void 0:n.lastFour}`})),s("mq-vspacer",{factor:6}),s("iframe",{frameborder:"0",style:{flex:"1",width:"100%","min-height":"250px"},allow:"clipboard-read; clipboard-write",src:`${this.cuiApiBaseUrl}/static/view-pan?${this.formatBaseSearchParams()}`})))};this.disableModalLoadingState=()=>{setTimeout((()=>{this.modal.setLoading(false)}),500)};this.showActivateCardModal=()=>{const t={padding:"var(--spacing-spacing600) var(--spacing-spacing600) 0"};this.modal.showModal("Activate card",s("iframe",{frameborder:"0",style:{flex:"1",width:"100%",height:"100%","min-height":`${this.isMobile?"100%":"166px"}`,margin:"auto"},scrolling:"no",src:`${this.cuiApiBaseUrl}/static/activate-card?${this.formatBaseSearchParams()}`}),"Enter your card details below.",null,false,"small",t,s("activate-card-skeleton",null));this.disableModalLoadingState()};this.showActivateCardSuccessModal=()=>{this.modal.showModal("",s("mq-activate-card-success",{onCloseActivateCardSuccess:this.handleCloseModal,style:{display:"flex",width:"100%","min-height":`${this.isMobile?"75%":"378px"}`,justifyContent:"center"}}),"",null,true,"small")};this.showActivateCardErrorModal=()=>{this.modal.showModal("",s("mq-activate-card-error",{onCloseActivateCardError:this.handleCloseModal,style:{display:"flex",width:"100%","min-height":`${this.isMobile?"75%":"385px"}`,margin:"auto"}}),"",null,true,"small")};this.unloadIframe=()=>{const t=this.modal.shadowRoot.querySelector("iframe");t.setAttribute("src","about:blank")};this.showSetPinModal=()=>{const t={padding:"var(--spacing-spacing600) var(--spacing-spacing600) 0"};this.modal.showModal("Set PIN",s("iframe",{frameborder:"0",style:{flex:"1",width:"100%",height:"100%","min-height":`${this.isMobile?"100%":"250px"}`,margin:"auto"},src:`${this.cuiApiBaseUrl}/static/set-pin?${this.formatBaseSearchParams()}`}),"Avoid simple PINs such as sequences (1234) or repeated digits (1111).",null,false,"small",t,s("set-pin-skeleton",null));this.unloadIframe();this.disableModalLoadingState()};this.showSetPinSuccessModal=t=>{this.modal.showModal("",s("mq-set-pin-success",{lastFour:t,onCloseSetPinSuccess:this.handleCloseModal,style:{margin:"auto","min-height":"75%"}}),"",null,true,"small")};this.showViewPinModal=()=>{const t=o.get(u);const i={padding:"var(--spacing-spacing600) var(--spacing-spacing600) 0"};this.modal.showModal("View PIN",s("iframe",{frameborder:"0",style:{display:"flex",width:"100%",height:"100%","min-height":`${this.isMobile?"100%":"0"}`,margin:"auto"},src:`${this.cuiApiBaseUrl}/static/reveal-pin?card_token=${this.cardToken}&auth_token=${t.execute()}&theme_name=${this.themeName}`}),null,null,false,"small",i,s("reveal-pin-skeleton",null));this.disableModalLoadingState()};this.reportCardClick=()=>{var t,i;this.modal.showModal("",s("replace-card",{cardToken:this.cardToken,cardholderToken:(t=this.card)===null||t===void 0?void 0:t.userToken,cardProductToken:(i=this.card)===null||i===void 0?void 0:i.cardProductToken,onReplaceSuccess:this.closeModalAndRefresh}),"",true)};this.handleCloseModal=()=>{this.modal.hideModal()};this.transitioncard=(t,i,e,a,r="01")=>{this.modal.showModal("",s("flex-container",{flexDirection:"column",alignItems:"center",justifyContent:"center"},s("mq-loader",null),s("mq-vspacer",{factor:5}),s("mq-text",{type:"titleSubSection"},e),s("mq-vspacer",{factor:5})));this.client.mutate({mutation:g(a),fetchPolicy:"no-cache",variables:{card_token:this.cardToken,reason_code:r,channel:"ADMIN",state:t}}).then((t=>{const r={message:`${e} succeeded`,type:"success"};if(!t.data[a]){r.message=`${e} failed`;r.type="error";this.modal.showModal(i,s("success-error-content",Object.assign({},r)))}else{this.closeModalAndRefresh()}})).catch((()=>{this.modal.showModal(i,s("success-error-content",{type:"error",message:`${e} failed`}))}))};this.closeModalAndRefresh=()=>{this.modal.hideModal();this.loadCard()};this.cardToken=undefined;this.activeEnvName="";this.card=undefined;this.client=undefined;this.cuiApiBaseUrl="";this.isMobile=undefined;this.showPan=false;this.themeName=undefined}connectedCallback(){let t=true;const i=new k;i.connectedCallback(this);y((i=>{if(i){this.loadEnvConfigVars();if(t){t=false;this.loadCard()}}}));this.mqComponentInit.emit({component:"card-component"});this.isMobile=b();this.initializeIframeListener();this.initializeModal()}render(){if(!x.mqCuiReady)return null;if(!this.card)return s("theme-provider",null,s("mq-loader",null));const t=r("lock.svg");return s(n,null,s("theme-provider",null,s("div",{class:"card-container"},s("div",{class:"card-comp-grid"},s("div",{class:"card-view-grid-item"},s("card-view",{"cardholder-name":`${this.card.user.firstName} ${this.card.user.lastName}`,"card-number":`••••${this.card.lastFour}`},!!C[this.card.state]&&s(a,null,s("div",{class:"card-status-overlay"}),s("div",{class:"card-status-container"},s("div",{class:"card-status-pill"},s("img",{src:t}),s("mq-text",{type:"small"},C[this.card.state])))))),s("div",{class:"balance-grid-item"},s("mq-text",{type:"small"},"Available Balance"),s("br",null),s("mq-text",{type:"titleSection"},"$73.80")),s("div",{class:"transact-summary-grid-item"},s("div",{class:"summary"},s("mq-text",{type:"small"},"Deposits this month"),s("mq-text",{styleOverride:S},"$0.00")),s("div",{class:"summary"},s("mq-text",{type:"small"},"Spend this month"),s("mq-text",{styleOverride:S},"$351.17"))),s("div",{class:"buttons-grid-item"},s("mq-button",{fullWidth:true,label:"View PIN",onClick:this.showViewPinModal}),this.card.state===v.UNACTIVATED&&s("mq-button",{fullWidth:true,label:"Activate card",onClick:this.showActivateCardModal}))))))}static get assetsDirs(){return["public"]}get el(){return c(this)}};j.style=$;export{j as card_component};
//# sourceMappingURL=p-b381b353.entry.js.map