/**
 * Cardholder UI Web Components v0.22.0
 * (c) 2024 Marqeta
 * @license MIT
 */
import{r as t,k as e,i as r,j as s}from"./p-18a64bdb.js";import{c as i,a6 as o,a7 as a,a8 as n}from"./p-675e89df.js";import{A as d}from"./p-52af63d3.js";import{i as c}from"./p-fd1eb924.js";import{o as l,m as h}from"./p-c7bc8265.js";import{i as p}from"./p-ad77a72d.js";import{C as m}from"./p-cb5bbf71.js";import"./p-0462f723.js";const u=":host{width:100%}*{box-sizing:border-box}.transaction-header{letter-spacing:0.15px;margin:0 auto var(--spacing-spacing400) 0}.mq-transaction-list{background:var(--components-universal-backgroundColor);padding:var(--components-universal-padding);border-radius:var(--components-universal-borderRadius);border:var(--components-universal-borderWidth) solid var(--components-universal-borderColor)}.container-grid{width:100%;background-color:var(--styles-background-surfacePrimaryColor);border-radius:var(--borderRadius-radius200);border-spacing:unset;border:var(--styles-border-borderWidth) solid var(--styles-border-borderDefaultColor)}mq-transaction-item:last-of-type .transaction-item:focus{border-bottom-left-radius:var(--borderRadius-radius200);border-bottom-right-radius:var(--borderRadius-radius200)}.no-transaction-header-row mq-transaction-item:first-of-type .transaction-item:focus{border-top-left-radius:var(--borderRadius-radius200);border-top-right-radius:var(--borderRadius-radius200)}.header{display:grid;text-align:left;grid-template-columns:2fr 1fr 1fr 1fr;padding:var(--spacing-spacing300) var(--spacing-spacing400);color:var(--styles-text-textBrandColor);border-bottom:var(--styles-border-borderWidth) solid var(--styles-border-borderDefaultColor);font-weight:var(--typography-body-strongFontWeight);gap:var(--spacing-spacing200)}.header-skeleton{border-bottom:var(--styles-border-borderWidth) solid var(--styles-border-borderDefaultColor)}.header th:last-child{text-align:right}.loader-container{width:100%}.loader-header{border-bottom-left-radius:0;border-bottom-right-radius:0;padding:12px 16px;border-bottom:var(--styles-border-borderWidth) solid var(--styles-border-borderDefaultColor)}.container-grid .loader-item{padding:18px 16px}.container-grid .loader-header mq-bone,.container-grid .loader-item mq-bone{display:contents}.load-more-btn{display:flex;justify-content:center;margin-top:var(--spacing-spacing600)}.no-transactions{display:block;margin-top:48px;text-align:center}";const b=u;var g;(function(t){t["LOAD_MORE"]="LOAD_MORE"})(g||(g={}));var y;(function(t){t["VIEW_TRANSACTION"]="VIEW_TRANSACTION"})(y||(y={}));const x=class{constructor(r){t(this,r);this.mqTransactionListLoadInitiated=e(this,"mqTransactionListLoadInitiated",7);this.mqTransactionListLoadCompleted=e(this,"mqTransactionListLoadCompleted",7);this.mqTransactionListActionTriggered=e(this,"mqTransactionListActionTriggered",7);this.mqTransactionListActionCompleted=e(this,"mqTransactionListActionCompleted",7);this.mqTransactionListHook=e(this,"mqTransactionListHook",7);this.txnDetailsModal=document.querySelector("mq-modal");this.initializeModal=()=>{if(!this.txnDetailsModal){document.body.appendChild(document.createElement("mq-modal"));this.txnDetailsModal=document.querySelector("mq-modal")}};this.loadMccIcons=async()=>{try{const t=i.get(o);this.txnIcons=await t.execute("txnIcons")}catch(t){d.Transactions.Exception(t===null||t===void 0?void 0:t.message)}};this.clickHandler=()=>{this.loadMoreTransactions()};this.language="en";this.showTitle=true;this.isLoading=true;this.hasMore=false;this.errorMessage=null;this.isMobile=false;this.txnIcons={};this.transactionsLists={pending:[],recent:[],transactions:[]};this.transactionsPaginationParams={startIndex:0,currentTimestamp:(new Date).toISOString(),getPending:true,limit:10}}connectedCallback(){l((t=>{t&&this.loadInitialTransactions()}));this.mqTransactionListLoadInitiated.emit();this.initializeModal();this.loadMccIcons();this.isMobile=c()}async loadInitialTransactions(){try{await this.tryLoadingTransactions();this.mqTransactionListLoadCompleted.emit({status:m.SUCCESS})}catch(t){this.handleLoadTransactionsError(t)}}async tryLoadingTransactions(){this.isLoading=true;const t=i.get(a);const e=await t.execute(this.transactionsPaginationParams);const{data:r,endIndex:s,hasMorePending:o,hasMore:n}=e;Object.assign(this.transactionsPaginationParams,{startIndex:s+1,getPending:o});this.addResponseDataToList(r);this.hasMore=n;this.isLoading=false}addResponseDataToList(t){t.forEach((t=>{const{status:e}=t;if(e.toLowerCase()===n.PENDING.toLowerCase()){this.transactionsLists.pending.push(t)}else if(p(t.created_time)){this.transactionsLists.recent.push(t)}else{this.transactionsLists.transactions.push(t)}}))}handleLoadTransactionsError(t,e=false){var r;this.isLoading=false;const s=t;const i=((r=s===null||s===void 0?void 0:s.originalError)===null||r===void 0?void 0:r.message)||"INTERNAL_ERROR";d.Transactions.Exception(s.message);this.errorMessage="It looks like weâ€™re having trouble with this request. Please try again or contact customer support.";if(e){this.mqTransactionListActionCompleted.emit({type:g.LOAD_MORE,status:m.ERROR,error:{code:i}})}else{this.mqTransactionListLoadCompleted.emit({status:m.ERROR,error:{code:i}})}}async loadMoreTransactions(){try{this.mqTransactionListActionTriggered.emit({type:g.LOAD_MORE});await this.tryLoadingTransactions();this.mqTransactionListActionCompleted.emit({type:g.LOAD_MORE,status:m.SUCCESS})}catch(t){this.handleLoadTransactionsError(t,true)}}renderSkeleton(t=true){const e=new Array(7).fill(0);return r("div",{class:"loader-container"},t&&r("mq-bone",{styleOverride:{margin:"0px 0px 16px 0px"},height:"28px",width:"200px"}),r("div",{class:`${t?"container-grid":""}`,style:{overflow:"hidden"}},t&&r("flex-container",{flexDirection:"row",alignItems:"center",gap:"16px",justifyContent:"space-between",styleOverride:this.isMobile?{display:"none"}:{padding:"16px"},class:"header-skeleton"},r("mq-bone",{height:"20px",width:"210px"}),r("mq-bone",{height:"20px",width:!this.isMobile?"95px":"72px",style:this.isMobile&&{display:"none"}}),r("mq-bone",{height:"20px",width:!this.isMobile?"95px":"72px",style:this.isMobile?{display:"none"}:{}}),r("mq-bone",{styleOverride:{marginLeft:"auto"},height:"20px",width:"95px"})),e.map(((t,e)=>r("host",{key:e},r("flex-container",{flexDirection:"row",alignItems:"center",gap:"16px",justifyContent:"space-between",styleOverride:{padding:"16px"}},r("flex-container",{flexDirection:"row",alignItems:"center",gap:"16px",justifyContent:"space-between",styleOverride:{flex:"1 0 0"}},r("mq-bone",{styleOverride:{borderRadius:"100%"},height:"32px",width:"32px"}),r("mq-bone",{height:"20px",width:!this.isMobile?"150px":"172px"})),r("mq-bone",{height:"20px",width:!this.isMobile?"95px":"72px",style:this.isMobile&&{display:"none"}}),r("mq-bone",{height:"20px",width:!this.isMobile?"95px":"72px",style:this.isMobile?{display:"none"}:{}}),r("mq-bone",{styleOverride:{marginLeft:"auto"},height:"20px",width:"95px"})))))))}handleKeyDown(t,e){if(t.key==="Enter"){this.handleTxnDetailTriggered(e)}}handleTxnDetailTriggered(t){this.mqTransactionListHook.emit({type:y.VIEW_TRANSACTION,data:{transactionToken:t===null||t===void 0?void 0:t.token}})}render(){if(!h.mqCuiReady){return null}const t=this.hasMore&&!this.isLoading&&!this.errorMessage;d.Transactions.viewTransactions();return r("theme-provider",null,r("div",{class:"mq-transaction-list"},this.errorMessage&&r("mq-alert",{type:"error",heading:"We've encountered a problem"},this.errorMessage),this.renderTransactionsSections(),t&&r("div",{class:"load-more-btn"},r("mq-button",{kind:"tertiary",label:"Load more transactions",onClick:this.clickHandler})),this.isLoading&&!this.transactionsLists.pending.length&&!this.transactionsLists.recent.length&&!this.transactionsLists.transactions.length&&this.renderSkeleton()))}renderTransactionsSections(){const t={pending:"Pending transactions",recent:"Recent transactions",previous:"Previous transactions",transactions:"Transactions"};const e=Object.keys(this.transactionsLists).filter((t=>!!this.transactionsLists[t].length));const s=e.length<1&&!this.errorMessage&&!this.isLoading;return r("div",null,e.map(((s,i)=>r("div",null,r("flex-container",{flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"0"},this.showTitle&&r("h2",{class:"transaction-header",id:"list-container--header"},r("mq-text",{type:"titleSection",content:s==="transactions"&&e.includes("recent")?t["previous"]:t[s]})),!this.errorMessage&&this.renderTransactionsList(this.transactionsLists[s],i===0,e.length-1===i)),i<e.length-1&&r("mq-vspacer",{factor:6})))),s&&r("div",{class:"no-transactions"},r("mq-text",{content:"No recent transactions to display. Refer to your statements for transactions older than 90 days."})))}renderTransactionsList(t,e=true,s=false){if(t.length>0){return r("table",{role:"grid",class:"container-grid"},!this.isMobile&&e&&r("thead",null,r("tr",{class:"header"},r("th",{role:"columnheader",scope:"col"},r("mq-text",{colorType:"brand",bold:true,content:"Description"})),r("th",{role:"columnheader",scope:"col"},r("mq-text",{colorType:"brand",bold:true,content:"Date"})),r("th",{role:"columnheader",scope:"col"},r("mq-text",{colorType:"brand",bold:true,content:"Type"})),r("th",{role:"columnheader",scope:"col"},r("mq-text",{colorType:"brand",bold:true,content:"Amount"})))),r("tbody",{class:e?"":"no-transaction-header-row"},t.map((t=>{const e=`${t.type}-${t.created_time}`;return r("mq-transaction-item",{key:e,isMobile:this.isMobile,transaction:t,onClick:()=>this.handleTxnDetailTriggered(t),onKeyDown:e=>this.handleKeyDown(e,t)})})),this.isLoading&&s&&this.renderSkeleton(false)))}}static get assetsDirs(){return["public"]}get el(){return s(this)}};x.style=b;export{x as mq_transaction_list};
//# sourceMappingURL=p-7443ff91.entry.js.map